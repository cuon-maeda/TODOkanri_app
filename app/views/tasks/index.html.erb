<div class="d-flex">
  <div class="task-search">
    <%= search_form_for @q, url: tasks_path, class: "border" do |f| %>
      <h5>検索欄</h5>
      <%= f.label :name_cont, '・タスク' %>
      <%= f.search_field :name_cont %>
      <br>
      <%= f.label :status_eq, '・進行状況' %>
      <%= f.select :status_eq, Task.statuses.map { |k,v| [Task.statuses_i18n[k], v]}, include_blank: '選択してください' %>
      <br>
      <%= f.label :priority_eq, '・優先度' %>
      <%= f.select :priority_eq, Task.priorities.map { |k,v| [Task.priorities_i18n[k], v]}, include_blank: '選択してください' %>
      <%= f.submit '検索' ,class: "btn btn-secondary w-100" %>
    <% end %>
  </div>
  <div class="task-list container border">
    <table class="table">
      <thead>
        <tr>
          <th scope="col">投稿日/期限</th>
          <th scope="col">名前</th>
          <th scope="col">タスク</th>
          <th scope="col">進行状況</th>
          <th scope="col">優先度</th>
          <th scope="col"><%=link_to "カテゴリー", categories_path%></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @tasks.each do |task| %>
          <tr>
            <th>
              <%= task.created_at.strftime('%m/%d')%> ~ 
                <% if task.limit_at.present?%>
                  <%= task.limit_at.strftime('%m/%d')%>
                <% else %>
                  なし
              <% end %>  
            </th>
            <td><%= task.user %></td>
            <td><%= task.name%></td>
            <td><%= task.status_i18n%></td>
            <td><%= task.priority_i18n%></td>
            <td>
              <% task.categories.each do |c| %>
                <%= link_to category_path(c) do %>
                  <span class="badge badge-info mr-1"><%= c.name %></span> 
                <% end %>  
              <% end %>
            </td> 
            <td><%=link_to "詳細", task_path(task)%></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
